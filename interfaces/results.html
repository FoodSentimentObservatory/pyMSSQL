<!DOCTYPE html>
<html>
<head>
    <link  rel="stylesheet" href="/static/css/bootstrap.css" type="text/css"/>
    <link  rel="stylesheet" href="/static/css/styles.css" type="text/css"/>
    <link  rel="stylesheet" href="/static/css/newStyles.css" type="text/css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src = "/static/js/bootstrap.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.2/modernizr.js"></script>

  </head>

  <body>
    <div class="se-pre-con"></div>
    
    <nav class="navbar navbar-inverse">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="#">Food Sentiment Observatory</a>
        </div>
        <ul class="nav navbar-nav">
          <li><a href="/index">Home</a></li>
          <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">Searches
            <span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a href="#">List of</a></li>
              <li><a href="#">Searches</a></li>
              <li><a href="#">For that sprint</a></li>
            </ul>
          </li>
          <li><a href="/manual">Manual</a></li>
          <li><a href="/collectionsPage">Collections</a></li>
        </ul>
      </div>
    </nav> 
    <div class="container" id="mainContainer">
    
    <div class="col-sm-12" id="whitie">
      <h2>Results</h2>
      <!-- generating the tabs from a list of group data -->
      <ul class='nav nav-tabs'>
      {% for group in groupList %}
          {% if group[2] == 0 %}
            <li class='active'><a data-toggle='tab' href='#{{group[0]}}' role="tab" onclick="changeKeywords('{{group[1]}}')">{{group[1]}}</a></li>
          {% else %}
            <li><a data-toggle='tab' href='#{{group[0]}}' role="tab" onclick="changeKeywords('{{group[1]}}')">{{group[1]}}</a></li> 
          {% endif %}  
          
      {% endfor %}
      <input type="hidden" name="keywordGroup" value=""> 
      </ul>    
      <div class='tab-content'>
      
      <!--each tab content is a separate item of a dictionary -->
      {% for key, values in dicw.items() %}
          {% if key==groupList[0][0] %}  
            <div id='{{key}}' class='tab-pane fade in active'>
          {% else %}  
            <div id='{{key}}' class='tab-pane fade'>
          {% endif %}  


          <!-- getting data about the group size and frequent words from the group list, if there's a match with the dict key, we get the data from that sublist-->
          {% for group in groupList %}
            {% if group[0]==key %}
              {% if group[3] > 0 %}
              <form role="form" autocomplete="off" action = "/frequentKeywordSearch">
                <input type="hidden" name="groupIdStr" value="{{group[0]}}">
                <input type="hidden" name="indexing" id="{{group[2]}}" value="">
                {% if group[2] == 0 %}
                <input type="hidden" name="groupOriginalName" id="groupOriginalName" value="{{group[1]}}">
                {% else %}
                <input type="hidden" name="groupOriginalName" id="groupOriginalName" value="">
                {% endif %}
                <input type="hidden" name="group" value="{{group[4]}}">
                <input type="hidden" name="tweets" value="{{group[5]}}">
                <div class="col-xs-8"><h4>There are {{group[3]}} tweets for this group of keywords.</h4></div>
                <div class="col-xs-4">
                  <button type="button" class="btn icon-btn btn-success smallButton" data-toggle="modal" data-target="#collectionsModal" >
                    <span class="glyphicon btn-glyphicon glyphicon-plus img-circle text-success">\</span>Add results for <strong>{{group[1]}}</strong> to a colection
                  </button>
                </div>
                <div class='wordBubble col-sm-12'>
                  <h4>Most frequent words:</h4>
                  <p>
                  {% for tup in group[4] %}
                    <button type="submit" class="btn btn-success spacedButton" name="word" value="{{tup[1]}}">{{tup[1]}} <span class="badge">{{tup[0]}}</span></button>
                  {% endfor %}  
                  </p>
                </div></form>
              {% else %}
                <h4>Sorry, no tweets were found</h4>
              {% endif %}    

            {% endif %}  
          {% endfor %} 
        <!--Displaying the tweet content-->  
        <div class="col-sm-12"><h4>Tweets</h4>  </div>
        {% if values|length > 0 %}
        <div id="groupsContent" class="col-sm-12">  
              
        {% for tweet in values %}  
          <div class='col-xs-8' id='tweet'>
            <div class='col-xs-6' id='author'>
              {% if tweet[3]=='True' %}
                <span style='color:#FFF;'>{{tweet[4]}}</span> <span style='color:#D3D3D3;'>@{{tweet[2]}}</span> 
                <span class='glyphicon glyphicon-ok blue'></span>
              {% else %}  
                <span style='color:#FFF;'>{{tweet[4]}}</span> <span style='color:#D3D3D3;'>@{{tweet[2]}}</span> 
              {% endif %}  
            </div>
            <div class='col-xs-6' id='time'>{{tweet[1]}}</div>
            <div class='col-xs-12' id='tweetText'>{{tweet[7]}}<br></div></div>
        {% endfor %}
        </div>
        {% else %}
          <h4>Sorry, no tweets were found</h4>
        {% endif %}
        </div>

       {% endfor %}
       </form>
       </div>
    </div>
    </div>

     <!-- Modal -->
    <div class="modal fade" id="collectionsModal" role="dialog" >
      <div class="modal-dialog">
      
        <!-- Modal content-->
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Select a collection or create a new one</h4>
          </div>
          <div class="modal-body" onload= "giveUniqueId()">
          <form action = "/saveCollection">
            <select class="form-control nav" id="listOfCollections" onchange="changeValues()">
            <option value="" disabled selected>Select a collection</option>
            <option disabled>______________________________________________</option>
            <option value="" >Create new collection</option>
            <option disabled>______________________________________________</option>
              {% for collection in listOfCollections %}
                <option value="{{collection[1]+'|'+collection[3]+'|'+collection[2]}}" >{{collection[3]}}</option>
              {% endfor %}  
            </select>
            <input type="hidden" name="collectionId" id="collectionId" value="">
            <h5>Name:</h5>
            <input type="text" class="form-control" name="collectionName" id = "collectionName" value="" placeholder="Type the name of the new collection" disabled>
            <h5>Description:</h5>
            <input type="text" class="form-control" name="collectionDescription" id="collectionDescription" value="" placeholder="Describe the content of the collection" disabled>
           <input type="hidden" name="dbName" id="dbName" value="">
           <input type="hidden" name="dateOfCreation" id="dateOfCreation" value="">
           <input type="hidden" name="groupOfKeywords" id="groupOfKeywords" value="">
          </div>
          <div class="modal-footer">
            <button type='submit' class='btn btn-success'>Add to collection</button>
             </form>
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
        
      </div>
    </div>
    <!--
      <footer class="footer" id="footerId">
      <div class="container"> 
        
      </div>
    </footer>-->
    <script src = "/static/js/scripts.js"></script>

</body>
</html>